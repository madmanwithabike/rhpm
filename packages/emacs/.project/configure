#!/bin/bash

set -eu
set -o pipefail

PRJ_PATH="`dirname \"${BASH_SOURCE[0]}\"`"
if [[ ! -d "$PRJ_PATH" ]]; then PRJ_PATH="$PWD"; fi
PRJ_PATH="`( cd -P \"$PRJ_PATH\" && pwd )`"
source "$PRJ_PATH/configs"
source "$PRJ_PATH/paths"

#./dependencies/$DEP_NAME

cd $SRC_PATH
git checkout $SRC_VERSION

patch -p1 --no-backup-if-mismatch \
       < "$PRJ_PATH"/patch/`
      `allow-negative-line-width-for-box-face-attribute.patch

./autogen.sh all
./configure --with-xft --with-x-toolkit=gtk3 --with-xwidgets \
            --with-modules
